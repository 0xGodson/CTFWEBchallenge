(function(e){function t(t){for(var o,n,s=t[0],l=t[1],c=t[2],d=0,p=[];d<s.length;d++)n=s[d],Object.prototype.hasOwnProperty.call(i,n)&&i[n]&&p.push(i[n][0]),i[n]=0;for(o in l)Object.prototype.hasOwnProperty.call(l,o)&&(e[o]=l[o]);u&&u(t);while(p.length)p.shift()();return r.push.apply(r,c||[]),a()}function a(){for(var e,t=0;t<r.length;t++){for(var a=r[t],o=!0,s=1;s<a.length;s++){var l=a[s];0!==i[l]&&(o=!1)}o&&(r.splice(t--,1),e=n(n.s=a[0]))}return e}var o={},i={app:0},r=[];function n(t){if(o[t])return o[t].exports;var a=o[t]={i:t,l:!1,exports:{}};return e[t].call(a.exports,a,a.exports,n),a.l=!0,a.exports}n.m=e,n.c=o,n.d=function(e,t,a){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:a})},n.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var a=Object.create(null);if(n.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)n.d(a,o,function(t){return e[t]}.bind(null,o));return a},n.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="/";var s=window["webpackJsonp"]=window["webpackJsonp"]||[],l=s.push.bind(s);s.push=t,s=s.slice();for(var c=0;c<s.length;c++)t(s[c]);var u=l;r.push([0,"chunk-vendors"]),a()})({0:function(e,t,a){e.exports=a("56d7")},"034f":function(e,t,a){"use strict";var o=a("85ec"),i=a.n(o);i.a},"2ca3":function(e,t,a){},"4bbf":function(e,t,a){e.exports=a.p+"img/logo_rpg7.97c0a3df.svg"},"56d7":function(e,t,a){"use strict";a.r(t);a("e260"),a("e6cf"),a("cca6"),a("a79d");var o=a("104d"),i=a("88eb"),r=a("2b0e"),n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{attrs:{id:"app"}},[a("Navbar"),a("Home")],1)},s=[],l=function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("b-navbar",{attrs:{type:"dark",variant:"dark"}},[o("b-navbar-brand",[o("img",{staticClass:"d-inline-block mr-2",attrs:{src:a("4bbf"),alt:"RPG-7 logo",width:"70px"}}),e._v(" RPGhost ")]),o("b-navbar-nav",{staticClass:"ml-auto"},[o("b-nav-form",{on:{submit:function(t){return t.preventDefault(),e.goToFile(t)}}},[o("b-input-group",[o("b-form-input",{attrs:{placeholder:"Enter file ID",required:""},model:{value:e.fileUUID,callback:function(t){e.fileUUID=t},expression:"fileUUID"}}),o("b-input-group-append",[o("b-button",{attrs:{variant:"primary",type:"submit"}},[o("b-icon-caret-right")],1)],1)],1)],1)],1)],1)},c=[],u=a("d0b9"),d=a("8f77"),p=a("042b"),f=a("50a6"),b=a("5e12"),h=a("ccc0"),m=a("4797"),v=a("1947"),y=a("7386"),g={name:"Navbar",data(){return{fileUUID:""}},methods:{goToFile(){let e=`${window.location.origin}/get/${this.fileUUID}`;window.open(e)}},components:{BNavbar:u["a"],BNavbarBrand:d["a"],BNavbarNav:p["a"],BNavForm:f["a"],BInputGroup:b["a"],BInputGroupAppend:h["a"],BFormInput:m["a"],BButton:v["a"],BIconCaretRight:y["a"]}},w=g,F=a("2877"),C=Object(F["a"])(w,l,c,!1,null,"649231be",null),x=C.exports,B=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("b-container",{staticClass:"full-height",attrs:{fluid:""}},[a("b-row",{staticClass:"h-100",attrs:{"align-v":"center"}},[a("b-col",{staticClass:"pt-5 pt-md-0 pb-5 pb-md-0",attrs:{md:""}},[a("h2",{staticClass:"text-center mb-3"},[e._v("Upload files")]),a("b-form",{staticClass:"mw-70 ml-auto mr-auto",on:{submit:function(t){return t.preventDefault(),e.uploadFiles(t)}}},[a("b-form-file",{attrs:{state:Boolean(e.files.length),multiple:"",disabled:e.busy,placeholder:"Choose a files or drop them here…","drop-placeholder":"Drop files here…"},model:{value:e.files,callback:function(t){e.files=t},expression:"files"}}),a("b-container",{staticClass:"mt-3",attrs:{fluid:""}},[a("b-row",{attrs:{"align-h":"around"}},[a("b-col",[a("b-button",{staticClass:"w-100",attrs:{type:"reset",variant:"outline-danger",disabled:!e.files.length||e.busy,size:"lg"}},[e._v(" Clear ")])],1),a("b-col",[a("b-button",{staticClass:"w-100",attrs:{type:"submit",variant:"primary",disabled:!e.files.length||e.busy,size:"lg"}},[e._v(" Send! ")])],1)],1)],1)],1)],1),a("b-col",{staticClass:"divided pt-5 pt-md-0 pb-5 pb-md-0",attrs:{md:""}},[a("h2",{staticClass:"text-center mb-3"},[e._v("Upload ZIP")]),a("b-form",{staticClass:"mw-70 ml-auto mr-auto",on:{submit:function(t){return t.preventDefault(),e.uploadZIP(t)}}},[a("b-form-file",{attrs:{state:Boolean(e.zipFile),placeholder:"Choose a file or drop it here…","drop-placeholder":"Drop file here…",disabled:e.busy,accept:"application/zip, application/x-zip-compressed, multipart/x-zip, .zip"},model:{value:e.zipFile,callback:function(t){e.zipFile=t},expression:"zipFile"}}),a("b-container",{staticClass:"mt-3",attrs:{fluid:""}},[a("b-row",{attrs:{"align-h":"around"}},[a("b-col",[a("b-button",{staticClass:"w-100",attrs:{type:"reset",variant:"outline-danger",disabled:!e.zipFile||e.busy,size:"lg"}},[e._v(" Clear ")])],1),a("b-col",[a("b-button",{staticClass:"w-100",attrs:{type:"submit",variant:"primary",disabled:!e.zipFile||e.busy,size:"lg"}},[e._v(" Send! ")])],1)],1)],1)],1)],1)],1),a("ConfirmationModal",{attrs:{"uploaded-files":e.uploadedFiles}})],1)},_=[],k=(a("ddb0"),a("1bbb")),z=a("a15b"),j=a("b28b"),D=a("11de"),U=a("c43f"),$=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("b-modal",{attrs:{id:"confirmationModal",title:"Confirm file upload",size:"xl","no-close-on-esc":"","no-close-on-backdrop":"","hide-header-close":"",scrollable:"",centered:"","cancel-title":"Close","ok-title":"Save","ok-disabled":e.busy||0===e.selected.length,"cancel-disabled":e.busy},on:{ok:function(t){return t.preventDefault(),e.confirmUpload(t)}}},[a("b-table",{ref:"table",staticClass:"m-0",attrs:{striped:"",small:"",hover:"","foot-clone":"","show-empty":"","primary-key":"id",busy:e.busy,items:e.files,fields:e.fields},scopedSlots:e._u([{key:"head(checkbox)",fn:function(){return[e._v(" Save? ")]},proxy:!0},{key:"cell(checkbox)",fn:function(t){return[t.item.saved_id?e._e():a("b-form-checkbox-group",{model:{value:e.selected,callback:function(t){e.selected=t},expression:"selected"}},[a("b-form-checkbox",{staticClass:"m-0",attrs:{value:t.item.id}})],1)]}},{key:"cell(saved_id)",fn:function(t){return[t.item.saved_id?a("b-form-input",{attrs:{readonly:"",value:e.window.location.origin+"/get/"+t.item.saved_id},on:{click:function(t){return t.stopPropagation(),t.preventDefault(),e.copyText(t)}}}):e._e()]}}])})],1)},M=[],O=(a("b680"),a("6aac")),I=a("29a1"),T=a("c3e6"),P=a("3b99");function S(e){return null===e?"null":"undefined"===typeof e?"undefined":"object"===typeof e?Array.isArray(e)?"array":"object":typeof e}function H(e){return"object"===S(e)?R(e):"array"===S(e)?N(e):e}function N(e){return e.map(H)}function R(e){const t={};for(const a in e)Object.prototype.hasOwnProperty.call(e,a)&&(t[a]=H(e[a]));return t}function A(e,t=[],a={}){const o={arrayBehaviour:a.arrayBehaviour||"replace"},i=t.map(e=>e||{}),r=e||{};for(let n=0;n<i.length;n++){const e=i[n],t=Object.keys(e);for(let a=0;a<t.length;a++){const i=t[a],n=e[i],s=S(n),l=S(r[i]);if("object"===s)if("undefined"!==l){const e="object"===l?r[i]:{};r[i]=A({},[e,R(n)],o)}else r[i]=R(n);else if("array"===s)if("array"===l){const e=N(n);r[i]="merge"===o.arrayBehaviour?r[i].concat(e):e}else r[i]=N(n);else r[i]=n}}return r}function E(e,...t){return A(e,t)}var G={name:"ConfirmationModal",props:{uploadedFiles:Array},data(){return{window:window,alreadyMounted:!1,files:[],selected:[],busy:!1,fields:[{key:"checkbox",label:""},{key:"initialName",label:"Filename",sortable:!0},{key:"size",label:"Size",formatter:e=>(e/1024).toFixed(2)+" KiB",sortByFormatted:!1,sortable:!0},{key:"saved_id",label:"URL"}]}},watch:{uploadedFiles(){this.files=E([],this.uploadedFiles),this.selected=[],this.busy=!1}},methods:{confirmUpload(){this.busy=!0;const e=this;for(const t of this.selected)e.$http.post("/confirm",{tmpId:t}).then(t=>{const a=t.data,o=e.files.find(e=>e.id===a.tmpId);o.saved_id=a.id,this.files=[...this.files.filter(e=>e.id!==o.id),o],this.selected=this.selected.filter(e=>e!==o.id),this.busy=!1}).catch(e=>{this.busy=!1,console.warn("Failed to confirm file",e,e.response),this.$bvToast.toast(e.response.data,{title:"Confirmation error",variant:"danger",autoHideDelay:1e4})})},copyText(e){const t=e.target;t.focus(),t.select();const a=document.execCommand("copy");a&&this.$bvToast.toast("URL copied!",{autoHideDelay:2e3})}},mounted(){this.alreadyMounted=!0},beforeDestroy(){this.alreadyMounted=!1},components:{BModal:O["a"],BTable:I["a"],BFormCheckbox:T["a"],BFormCheckboxGroup:P["a"],BFormInput:m["a"]}},Z=G,L=(a("fb39"),Object(F["a"])(Z,$,M,!1,null,"3d26e48a",null)),J=L.exports,q={name:"Home",data(){return{files:[],zipFile:null,busy:!1,uploadedFiles:[]}},methods:{uploadFiles(){this.busy=!0;const e=new FormData;let t=0;for(const a of this.files){if(a.size>10485760)return this.$bvToast.toast("File is larger than 10 MiB.",{title:"Upload error",variant:"danger",autoHideDelay:4e3}),this.busy=!1,void(this.files=[]);e.append("file"+t,a),++t}this.$http.post("/uploadFiles",e).then(e=>{this.busy=!1;const t=e.data;this.files=[],this.uploadedFiles=t,this.$bvModal.show("confirmationModal")}).catch(e=>{this.busy=!1,console.warn("Failed to upload file",e,e.response),this.$bvToast.toast(e.response.data,{title:"Upload error",variant:"danger",autoHideDelay:1e4})})},uploadZIP(){if(this.zipFile.size>10485760)return this.$bvToast.toast("File is larger than 10 MiB.",{title:"Upload error",variant:"danger",autoHideDelay:4e3}),this.busy=!1,void(this.zipFile=null);this.busy=!0;const e=new FormData;e.append("archive",this.zipFile),this.$http.post("/uploadZip",e).then(e=>{this.busy=!1;const t=e.data;this.zipFile=null,this.uploadedFiles=t,this.$bvModal.show("confirmationModal")}).catch(e=>{this.busy=!1,console.warn("Failed to upload file",e,e.response),this.$bvToast.toast(e.response.data,{title:"Upload error",variant:"danger",autoHideDelay:1e4})})}},components:{ConfirmationModal:J,BContainer:k["a"],BRow:z["a"],BCol:j["a"],BForm:D["a"],BFormFile:U["a"],BButton:v["a"]}},K=q,Q=(a("c6f3"),Object(F["a"])(K,B,_,!1,null,"66c15e6e",null)),V=Q.exports,W={name:"App",components:{Home:V,Navbar:x}},X=W,Y=(a("034f"),Object(F["a"])(X,n,s,!1,null,null,null)),ee=Y.exports,te=(a("f9e3"),a("2dd8"),a("2bba"),a("c1ee"),a("bc3a")),ae=a.n(te);r["default"].use(o["a"]),r["default"].use(i["a"]);const oe=ae.a.create({baseURL:"/api/",headers:{Accept:"application/json","Content-Type":"application/json"}});r["default"].prototype.$http=oe,r["default"].config.productionTip=!1,new r["default"]({render:e=>e(ee)}).$mount("#app")},"85ec":function(e,t,a){},c6f3:function(e,t,a){"use strict";var o=a("2ca3"),i=a.n(o);i.a},f786:function(e,t,a){},fb39:function(e,t,a){"use strict";var o=a("f786"),i=a.n(o);i.a}});