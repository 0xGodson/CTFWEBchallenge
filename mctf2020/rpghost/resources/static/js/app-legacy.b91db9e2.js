(function(e){function t(t){for(var n,i,l=t[0],s=t[1],c=t[2],d=0,f=[];d<l.length;d++)i=l[d],Object.prototype.hasOwnProperty.call(o,i)&&o[i]&&f.push(o[i][0]),o[i]=0;for(n in s)Object.prototype.hasOwnProperty.call(s,n)&&(e[n]=s[n]);u&&u(t);while(f.length)f.shift()();return r.push.apply(r,c||[]),a()}function a(){for(var e,t=0;t<r.length;t++){for(var a=r[t],n=!0,l=1;l<a.length;l++){var s=a[l];0!==o[s]&&(n=!1)}n&&(r.splice(t--,1),e=i(i.s=a[0]))}return e}var n={},o={app:0},r=[];function i(t){if(n[t])return n[t].exports;var a=n[t]={i:t,l:!1,exports:{}};return e[t].call(a.exports,a,a.exports,i),a.l=!0,a.exports}i.m=e,i.c=n,i.d=function(e,t,a){i.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:a})},i.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i.t=function(e,t){if(1&t&&(e=i(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var a=Object.create(null);if(i.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var n in e)i.d(a,n,function(t){return e[t]}.bind(null,n));return a},i.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return i.d(t,"a",t),t},i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},i.p="/";var l=window["webpackJsonp"]=window["webpackJsonp"]||[],s=l.push.bind(l);l.push=t,l=l.slice();for(var c=0;c<l.length;c++)t(l[c]);var u=s;r.push([0,"chunk-vendors"]),a()})({0:function(e,t,a){e.exports=a("56d7")},"034f":function(e,t,a){"use strict";var n=a("85ec"),o=a.n(n);o.a},"2ca3":function(e,t,a){},"4bbf":function(e,t,a){e.exports=a.p+"img/logo_rpg7.97c0a3df.svg"},"56d7":function(e,t,a){"use strict";a.r(t);a("e260"),a("e6cf"),a("cca6"),a("a79d");var n=a("104d"),o=a("88eb"),r=a("2b0e"),i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{attrs:{id:"app"}},[a("Navbar"),a("Home")],1)},l=[],s=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("b-navbar",{attrs:{type:"dark",variant:"dark"}},[n("b-navbar-brand",[n("img",{staticClass:"d-inline-block mr-2",attrs:{src:a("4bbf"),alt:"RPG-7 logo",width:"70px"}}),e._v(" RPGhost ")]),n("b-navbar-nav",{staticClass:"ml-auto"},[n("b-nav-form",{on:{submit:function(t){return t.preventDefault(),e.goToFile(t)}}},[n("b-input-group",[n("b-form-input",{attrs:{placeholder:"Enter file ID",required:""},model:{value:e.fileUUID,callback:function(t){e.fileUUID=t},expression:"fileUUID"}}),n("b-input-group-append",[n("b-button",{attrs:{variant:"primary",type:"submit"}},[n("b-icon-caret-right")],1)],1)],1)],1)],1)],1)},c=[],u=(a("99af"),a("d0b9")),d=a("8f77"),f=a("042b"),p=a("50a6"),b=a("5e12"),v=a("ccc0"),h=a("4797"),m=a("1947"),y=a("7386"),g={name:"Navbar",data:function(){return{fileUUID:""}},methods:{goToFile:function(){var e="".concat(window.location.origin,"/get/").concat(this.fileUUID);window.open(e)}},components:{BNavbar:u["a"],BNavbarBrand:d["a"],BNavbarNav:f["a"],BNavForm:p["a"],BInputGroup:b["a"],BInputGroupAppend:v["a"],BFormInput:h["a"],BButton:m["a"],BIconCaretRight:y["a"]}},w=g,F=a("2877"),C=Object(F["a"])(w,s,c,!1,null,"649231be",null),x=C.exports,B=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("b-container",{staticClass:"full-height",attrs:{fluid:""}},[a("b-row",{staticClass:"h-100",attrs:{"align-v":"center"}},[a("b-col",{staticClass:"pt-5 pt-md-0 pb-5 pb-md-0",attrs:{md:""}},[a("h2",{staticClass:"text-center mb-3"},[e._v("Upload files")]),a("b-form",{staticClass:"mw-70 ml-auto mr-auto",on:{submit:function(t){return t.preventDefault(),e.uploadFiles(t)}}},[a("b-form-file",{attrs:{state:Boolean(e.files.length),multiple:"",disabled:e.busy,placeholder:"Choose a files or drop them here…","drop-placeholder":"Drop files here…"},model:{value:e.files,callback:function(t){e.files=t},expression:"files"}}),a("b-container",{staticClass:"mt-3",attrs:{fluid:""}},[a("b-row",{attrs:{"align-h":"around"}},[a("b-col",[a("b-button",{staticClass:"w-100",attrs:{type:"reset",variant:"outline-danger",disabled:!e.files.length||e.busy,size:"lg"}},[e._v(" Clear ")])],1),a("b-col",[a("b-button",{staticClass:"w-100",attrs:{type:"submit",variant:"primary",disabled:!e.files.length||e.busy,size:"lg"}},[e._v(" Send! ")])],1)],1)],1)],1)],1),a("b-col",{staticClass:"divided pt-5 pt-md-0 pb-5 pb-md-0",attrs:{md:""}},[a("h2",{staticClass:"text-center mb-3"},[e._v("Upload ZIP")]),a("b-form",{staticClass:"mw-70 ml-auto mr-auto",on:{submit:function(t){return t.preventDefault(),e.uploadZIP(t)}}},[a("b-form-file",{attrs:{state:Boolean(e.zipFile),placeholder:"Choose a file or drop it here…","drop-placeholder":"Drop file here…",disabled:e.busy,accept:"application/zip, application/x-zip-compressed, multipart/x-zip, .zip"},model:{value:e.zipFile,callback:function(t){e.zipFile=t},expression:"zipFile"}}),a("b-container",{staticClass:"mt-3",attrs:{fluid:""}},[a("b-row",{attrs:{"align-h":"around"}},[a("b-col",[a("b-button",{staticClass:"w-100",attrs:{type:"reset",variant:"outline-danger",disabled:!e.zipFile||e.busy,size:"lg"}},[e._v(" Clear ")])],1),a("b-col",[a("b-button",{staticClass:"w-100",attrs:{type:"submit",variant:"primary",disabled:!e.zipFile||e.busy,size:"lg"}},[e._v(" Send! ")])],1)],1)],1)],1)],1)],1),a("ConfirmationModal",{attrs:{"uploaded-files":e.uploadedFiles}})],1)},_=[],k=a("b85c"),j=a("1bbb"),z=a("a15b"),O=a("b28b"),D=a("11de"),U=a("c43f"),M=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("b-modal",{attrs:{id:"confirmationModal",title:"Confirm file upload",size:"xl","no-close-on-esc":"","no-close-on-backdrop":"","hide-header-close":"",scrollable:"",centered:"","cancel-title":"Close","ok-title":"Save","ok-disabled":e.busy||0===e.selected.length,"cancel-disabled":e.busy},on:{ok:function(t){return t.preventDefault(),e.confirmUpload(t)}}},[a("b-table",{ref:"table",staticClass:"m-0",attrs:{striped:"",small:"",hover:"","foot-clone":"","show-empty":"","primary-key":"id",busy:e.busy,items:e.files,fields:e.fields},scopedSlots:e._u([{key:"head(checkbox)",fn:function(){return[e._v(" Save? ")]},proxy:!0},{key:"cell(checkbox)",fn:function(t){return[t.item.saved_id?e._e():a("b-form-checkbox-group",{model:{value:e.selected,callback:function(t){e.selected=t},expression:"selected"}},[a("b-form-checkbox",{staticClass:"m-0",attrs:{value:t.item.id}})],1)]}},{key:"cell(saved_id)",fn:function(t){return[t.item.saved_id?a("b-form-input",{attrs:{readonly:"",value:e.window.location.origin+"/get/"+t.item.saved_id},on:{click:function(t){return t.stopPropagation(),t.preventDefault(),e.copyText(t)}}}):e._e()]}}])})],1)},$=[],I=(a("4de4"),a("7db0"),a("b680"),a("2909")),T=a("6aac"),P=a("29a1"),S=a("c3e6"),H=a("3b99"),N=(a("d81d"),a("b64b"),a("53ca"));function A(e){return null===e?"null":"undefined"===typeof e?"undefined":"object"===Object(N["a"])(e)?Array.isArray(e)?"array":"object":Object(N["a"])(e)}function R(e){return"object"===A(e)?G(e):"array"===A(e)?E(e):e}function E(e){return e.map(R)}function G(e){var t={};for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&(t[a]=R(e[a]));return t}function Z(e){for(var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},n={arrayBehaviour:a.arrayBehaviour||"replace"},o=t.map((function(e){return e||{}})),r=e||{},i=0;i<o.length;i++)for(var l=o[i],s=Object.keys(l),c=0;c<s.length;c++){var u=s[c],d=l[u],f=A(d),p=A(r[u]);if("object"===f)if("undefined"!==p){var b="object"===p?r[u]:{};r[u]=Z({},[b,G(d)],n)}else r[u]=G(d);else if("array"===f)if("array"===p){var v=E(d);r[u]="merge"===n.arrayBehaviour?r[u].concat(v):v}else r[u]=E(d);else r[u]=d}return r}function L(e){for(var t=arguments.length,a=new Array(t>1?t-1:0),n=1;n<t;n++)a[n-1]=arguments[n];return Z(e,a)}var J={name:"ConfirmationModal",props:{uploadedFiles:Array},data:function(){return{window:window,alreadyMounted:!1,files:[],selected:[],busy:!1,fields:[{key:"checkbox",label:""},{key:"initialName",label:"Filename",sortable:!0},{key:"size",label:"Size",formatter:function(e){return"".concat((e/1024).toFixed(2)," KiB")},sortByFormatted:!1,sortable:!0},{key:"saved_id",label:"URL"}]}},watch:{uploadedFiles:function(){this.files=L([],this.uploadedFiles),this.selected=[],this.busy=!1}},methods:{confirmUpload:function(){var e=this;this.busy=!0;var t,a=this,n=Object(k["a"])(this.selected);try{for(n.s();!(t=n.n()).done;){var o=t.value;a.$http.post("/confirm",{tmpId:o}).then((function(t){var n=t.data,o=a.files.find((function(e){return e.id===n.tmpId}));o.saved_id=n.id,e.files=[].concat(Object(I["a"])(e.files.filter((function(e){return e.id!==o.id}))),[o]),e.selected=e.selected.filter((function(e){return e!==o.id})),e.busy=!1})).catch((function(t){e.busy=!1,console.warn("Failed to confirm file",t,t.response),e.$bvToast.toast(t.response.data,{title:"Confirmation error",variant:"danger",autoHideDelay:1e4})}))}}catch(r){n.e(r)}finally{n.f()}},copyText:function(e){var t=e.target;t.focus(),t.select();var a=document.execCommand("copy");a&&this.$bvToast.toast("URL copied!",{autoHideDelay:2e3})}},mounted:function(){this.alreadyMounted=!0},beforeDestroy:function(){this.alreadyMounted=!1},components:{BModal:T["a"],BTable:P["a"],BFormCheckbox:S["a"],BFormCheckboxGroup:H["a"],BFormInput:h["a"]}},q=J,K=(a("fb39"),Object(F["a"])(q,M,$,!1,null,"3d26e48a",null)),Q=K.exports,V={name:"Home",data:function(){return{files:[],zipFile:null,busy:!1,uploadedFiles:[]}},methods:{uploadFiles:function(){var e=this;this.busy=!0;var t,a=new FormData,n=0,o=Object(k["a"])(this.files);try{for(o.s();!(t=o.n()).done;){var r=t.value;if(r.size>10485760)return this.$bvToast.toast("File is larger than 10 MiB.",{title:"Upload error",variant:"danger",autoHideDelay:4e3}),this.busy=!1,void(this.files=[]);a.append("file".concat(n),r),++n}}catch(i){o.e(i)}finally{o.f()}this.$http.post("/uploadFiles",a).then((function(t){e.busy=!1;var a=t.data;e.files=[],e.uploadedFiles=a,e.$bvModal.show("confirmationModal")})).catch((function(t){e.busy=!1,console.warn("Failed to upload file",t,t.response),e.$bvToast.toast(t.response.data,{title:"Upload error",variant:"danger",autoHideDelay:1e4})}))},uploadZIP:function(){var e=this;if(this.zipFile.size>10485760)return this.$bvToast.toast("File is larger than 10 MiB.",{title:"Upload error",variant:"danger",autoHideDelay:4e3}),this.busy=!1,void(this.zipFile=null);this.busy=!0;var t=new FormData;t.append("archive",this.zipFile),this.$http.post("/uploadZip",t).then((function(t){e.busy=!1;var a=t.data;e.zipFile=null,e.uploadedFiles=a,e.$bvModal.show("confirmationModal")})).catch((function(t){e.busy=!1,console.warn("Failed to upload file",t,t.response),e.$bvToast.toast(t.response.data,{title:"Upload error",variant:"danger",autoHideDelay:1e4})}))}},components:{ConfirmationModal:Q,BContainer:j["a"],BRow:z["a"],BCol:O["a"],BForm:D["a"],BFormFile:U["a"],BButton:m["a"]}},W=V,X=(a("c6f3"),Object(F["a"])(W,B,_,!1,null,"66c15e6e",null)),Y=X.exports,ee={name:"App",components:{Home:Y,Navbar:x}},te=ee,ae=(a("034f"),Object(F["a"])(te,i,l,!1,null,null,null)),ne=ae.exports,oe=(a("f9e3"),a("2dd8"),a("2bba"),a("c1ee"),a("bc3a")),re=a.n(oe);r["default"].use(n["a"]),r["default"].use(o["a"]);var ie=re.a.create({baseURL:"/api/",headers:{Accept:"application/json","Content-Type":"application/json"}});r["default"].prototype.$http=ie,r["default"].config.productionTip=!1,new r["default"]({render:function(e){return e(ne)}}).$mount("#app")},"85ec":function(e,t,a){},c6f3:function(e,t,a){"use strict";var n=a("2ca3"),o=a.n(n);o.a},f786:function(e,t,a){},fb39:function(e,t,a){"use strict";var n=a("f786"),o=a.n(n);o.a}});